<html>
	<head>
		<title> Gurka.se 2.0 </title>
		<script type = "text/javascript" 
			src = "https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js">
		</script>
		<script>
			var increase = 0;
			var angle = getCookie("gurkor");


			$(document).ready(function() {
				$("#gurka").click(function() {
					increase = 10 * Math.max((increase / 9.7), 1);
				});
				$("#save").click(function() {
					document.cookie = "gurkor=" + Math.floor(angle / 360) + ";";
					alert("SAVE!");
					alert(document.cookie);
				});
			});

			function tick() {
				angle += increase;
				if(increase > 0) increase -= 0.1;
				if(increase < 0) increase += 0.1;
				$("#gurka").each(function() {
					var deg = angle;
					var rotate = 'rotate(' + deg + 'deg)';
					$(this).css({ 
						'-webkit-transform': rotate,
						'-moz-transform': rotate,
						'-o-transform': rotate,
						'-ms-transform': rotate,
						'transform': rotate 
					});
				});
				$("#varv").text("Gurkor: " + Math.floor(angle / 360));
			}
			
			function getCookie(cname) {
			    var name = cname + "=";
			    var decodedCookie = decodeURIComponent(document.cookie);
			    var ca = decodedCookie.split(';');
			    for(var i = 0; i <ca.length; i++) {
				var c = ca[i];
				while (c.charAt(0) == ' ') {
				    c = c.substring(1);
				}
				if (c.indexOf(name) == 0) {
				    return c.substring(name.length, c.length);
				}
			    }
			    return "";
			}
			
			setInterval(tick, 10);
		</script>
	</head>
	<body>
		<img id="gurka" src="https://www.miss-thrifty.co.uk/wp-content/uploads/2010/04/cucumber-garden-bugs.jpg">
		<p id="varv"></p>
		<button id="save">Save!</button>
	</body>
</html>
